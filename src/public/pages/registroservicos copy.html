<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <title>Registro de Serviços</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@200;400;600&family=Roboto:ital,wght@0,400;1,500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="tabelaDeRegistro.css" />
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <script id="search-js" defer="" src="https://api.mapbox.com/search-js/v1.0.0-beta.18/web.js"></script>

    <link
  rel="stylesheet"
  href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.0/mapbox-gl-geocoder.css"
  type="text/css"
/>

  </head>
  <body>
    <header
      class="navbar navbar-expand-lg navbar-light bg-light fixed-header"
      style="background-color: #e9e4ff !important"
    >
      <a class="navbar-brand" href="#"
        ><img src="imgs/Logo.png" alt="" style="width: 100px" />FromHome</a
      >
      <button
        class="navbar-toggler"
        type="button"
        data-toggle="collapse"
        data-target="#navbarNav"
        aria-controls="navbarNav"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <i class="fa fa-bars"></i>
      </button>
      <div
        class="collapse navbar-collapse justify-content-center"
        style="margin-right: 100px"
        id="navbarNav"
        id="navbarNav"
      >
        <ul class="navbar-nav text-center">
          <li class="nav-item">
            <a class="nav-link" href="#">Sobre</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">Suas Demandas</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">Criar Demanda</a>
          </li>
        </ul>
      </div>
      <div class="nav-item dropdown ml-2">
        <a
          class="nav-link dropdown-toggle"
          href="#"
          id="profileDropdown"
          data-toggle="dropdown"
          aria-haspopup="true"
          aria-expanded="false"
        >
          <img
            src="imgs/foto_perfil.avif"
            alt="Sua Foto de Perfil"
            class="rounded-circle"
            width="40"
            height="40"
          />
        </a>
        <div
          class="dropdown-menu dropdown-menu-right"
          aria-labelledby="profileDropdown"
          style="
            background-color: rgb(229, 216, 255);
            color: rgb(0, 0, 0);
            border: 3px;
          "
        >
          <a class="dropdown-item" href="#">Perfil</a>
          <div class="dropdown-divider"></div>
          <a
            class="dropdown-item"
            href="#confirmarPagamento"
            data-toggle="modal"
            >Pagamentos</a
          >
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="#">Sair</a>
        </div>
      </div>
    </header>

    <!-- Conteúdo principal da página -->
    <div class="content" style="margin-bottom: 60px; padding-bottom: 10%">
      <!-- conteúdo principal -->
      <div class="row mt-5 justify-content-center">
        <div class="col-lg-7 mx-auto">
          <div class="card mt-5 mx-auto p-4" style="overflow-y: auto">
            <div class="card-body">
              <h1 class="text-center"><b>Registro de Serviço</b></h1>
            </div>
            <div class="container mt-5">
              <form class="row g-3" method="POST" >
                <div class="col-md-6">
                  <label for="inputNameS" class="form-label"
                    >Nome do serviço</label
                  >
                  <input
                    name="nome"
                    class="form-control"
                    style="width: 300px"
                    id="inputNomeServico"
                  />
                </div>
                <div class="col-md-4">
                  <label
                    name="categoria"
                    for="inputOpcoes"
                    class="form-label"
                    >Categoria</label
                  >
                  <select id="inputOpcoes" class="form-select inputOpcoes">
                    <option selected>Selecione</option>
                    <option>Babá Cuidados com Crianças</option>
                    <option>Cozinha e Culinária</option>
                    <option>Cuidados com Animais de Estimação</option>
                    <option>Jardinagem</option>  
                    <option>Limpeza</option>
                    <option>Manutenção Residencial</option>
                    <option>Motorista Particular</option>
                    <option>Organização de Espaços</option>
                    <option>Serviços de Lavanderia</option>
                    <option>Tutoria Acadêmica</option>
                    <option>Outro</option>
                    
                  </select>
                </div>
                <div class="col-md-6">
                  <label for="inputDescricaoServico" class="form-label"
                    >Descrição do serviço</label
                  >
                  <input
                    name="descricao"
                    class="form-control"
                    style="height: 90px; width: 300px"
                    id="inputDescricaoServico"
                  />
                </div>
                <div class="col-md-6">
                  <label for="inputLocal" class="txt-s txt-bold color-gray mb3">Endereco</label>
                  <input class="input mb12 form-control" placeholder="Escreva seu endereco" autocomplete="address-line1" id="inputLocal">
                  <div id="manual-entry" class="w180 mt6 link txt-ms border-b color-gray color-black-on-hover"></div>
                  <div class="secondary-inputs hide">
                      <label class="txt-s txt-bold color-gray mb3">Cidade</label>
                      <input class="input mb12 form-control" placeholder="Cidade" autocomplete="address-level2" id="cityInput">
                      <label class="txt-s txt-bold color-gray mb3">Estado / Região</label>
                      <input class="input mb12 form-control" placeholder="Estado / Região" autocomplete="address-level1" id="stateInput">
                  </div>
              </div>
              
                <div class="col-md-6">
                  <label for="inputFotos" class="form-label"
                    >Fotos(opcional)</label>
                  <input
                    name="foto"
                    type="file"
                    class="form-control"
                    id="inputFotos"
                    accept="image/*"
                    style="width: 300px"
                  />
                </div>
                <div class="col-md-4">
                  <label for="inputDisponibilidade" class="form-label"
                    >Disponibilidade</label
                  >
                  <input
                    name="disponibilidade"
                    type="time"
                    class="form-control"
                    id="inputDisponibilidade"
                  />
                </div>
                <div class="col-md-6">
                  <label for="inputPreco" class="form-label">Preço</label>
                  <input
                    name="preco"
                    type="number"
                    class="form-control"
                    id="inputPreco"
                    step="000.01"
                    placeholder="R$:"
                    style="width: 300px"
                  />
                </div>
                  <div class="col-md-4">
                    <label for="inputData" class="form-label">Data do serviço</label>
                    <input
                      name="data"
                      type="date"
                      class="form-control"
                      id="inputData"
                      pattern="[0-9]{4}-[0-9]{2}-[0-9]{2}"
                    />
                    <span class="validity"> </span>
                  </div>
                 
                  <div class="col-md-2">
                    <!-- Visual confirmation map -->
                    <div id="minimap-container" class="none h240 w360 relative mt18"></div>
                  </div>
                </div>
                <div id="validation-msg" class="mt24 txt-m txt-bold none">Test</div>
                
                <div class="container mt-5">
                  <div class="row">
                    <div class="col"></div>
                    <div class="col-md-5">
                      <div class="form-check">
                        <input
                          name="contato"
                          class="form-check-input"
                          type="checkbox"
                          id="gridCheck"
                        />
                        <label class="form-check-label" for="gridCheck">
                          Mostrar meu número de contato
                        </label>
                      </div>
                    </div>
                    <div class="col-auto">
                      <button
                        id="postarBtn"
                        type="button"
                        class="btn button-primary"
                      >
                        Postar
                      </button>
                    </div>
                  </div>
                </div>
              </form>


              
            </div>
          </div>
        </div>
      </div>
    </div>

    <footer
      class="text-light mt-5"
      style="
        background-color: rgb(58, 50, 77);
       
        bottom: 0;
        width: 100%;
        margin-top: 20px;
      "
    >
      <div
        class="navbar navbar-expand-lg navbar-light bg-light"
        style="background-color: #e9e4ff !important"
      >
        <a class="navbar-brand" href="#"
          ><img src="img/Logo.png" alt="" style="width: 100px"
        /></a>
        <button
          class="navbar-toggler"
          type="button"
          data-toggle="collapse"
          data-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div
          class="collapse navbar-collapse justify-content-center"
          style="margin-right: 100px"
          id="navbarNav"
        >
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" id="termosDeUso">Termos de Uso</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="politicasPrivacidade"
                >Políticas de Privacidade</a
              >
            </li>
          </ul>
        </div>
      </div>
      <div class="container text-center mt-1">
        <p>Contato: contato@fromhome.com<br />Telefone: (11) 1234-5678</p>
      </div>
      <p class="text-center small">
        &copy; 2023 FromHome. Todos os direitos reservados.
      </p>
    </footer>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="server.js"></script>
  
 

     
  <script>
             
    const ACCESS_TOKEN = 'pk.eyJ1Ijoid2FuZXNzYWNyaXN0aW5hIiwiYSI6ImNscHBmeDN3bDBwNXoyanBwNDd1NHdjbWoifQ.mn9RiaWKROJGkiLQynhltg';

    let autofillCollection;
    let minimap;
             
          
              // Form operation functions
              function showMap() {
                  const el = document.getElementById("minimap-container");
                  el.classList.remove("none");
              }
          
              function hideMap() {
                  const el = document.getElementById("minimap-container");
                  el.classList.add("none");
              }

              const manualEntryButton = document.getElementById("manual-entry");
if (manualEntryButton) {
manualEntryButton.addEventListener("click", expandForm);
}
          
              function expandForm() {
                  document.getElementById("manual-entry").classList.add("hide");
                  document.querySelector(".secondary-inputs").classList.remove("hide");
              }
          
              function collapseForm() {
                  document.getElementById("manual-entry").classList.remove("hide");
                  document.querySelector(".secondary-inputs").classList.add("hide");
              }
          
              function setValidationText(color, msg, clear = false) {
                  const validationTextElement = document.getElementById("validation-msg");
                  if (clear) validationTextElement.classList.add("none");
                  validationTextElement.classList.remove("color-green", "color-red");
                  validationTextElement.classList.add(`color-${color}`);
                  validationTextElement.innerText = msg;
                  validationTextElement.classList.remove("none");
              }
          
              function submitForm() {
                  setValidationText("green", "Order successfully submitted.");
                  setTimeout(() => {
                      resetForm();
                  }, 2500);
              }
          
              function resetForm() {
                  const inputs = document.querySelectorAll("input");
                  inputs.forEach(input => input.value = "");
                  collapseForm();
                  setValidationText("green", "", true)
                  autofillCollection.update();
                  minimap.feature = null;
              }
          
              // Bind functions to HTML buttons
              document.getElementById("manual-entry").addEventListener("click", expandForm);
          
              // Autofill initialization
              document.getElementById("search-js").onload = () => {
                  mapboxsearch.config.accessToken = ACCESS_TOKEN;
          
                  autofillCollection = mapboxsearch.autofill({});
          
                  minimap = new MapboxAddressMinimap();
                  minimap.canAdjustMarker = true;
                  minimap.satelliteToggle = true;
                  minimap.onSaveMarkerLocation = (lnglat) => {
                      console.log(`Marker moved to ${lnglat}`);
                  };
                  const minimapContainer = document.getElementById("minimap-container");
                  minimapContainer.appendChild(minimap);
          
                  autofillCollection.addEventListener(
                      "retrieve",
                      async (e) => {
                          expandForm();
                          if (minimap) {
                              minimap.feature = e.detail.features[0];
                              showMap();
                          }
                      }
                  );

                  document.addEventListener("DOMContentLoaded", () => {
                  const form = document.forms.checkoutForm;
                  
    form.addEventListener("submit", async (e) => {
        e.preventDefault();

        document.addEventListener('DOMContentLoaded', function() {
        // Obtendo dados do formulário
        const addressInput = document.getElementById("InputLocal");
        const cityInput = document.getElementById("cityInput");
        const stateInput = document.getElementById("stateInput");

        // Obtendo dados da biblioteca Mapbox Search
        const address = autofillCollection.get("address-line1");

        // Criando um objeto com os dados do formulário
        const formData = {
            address: addressInput.value,
            city: cityInput.value,
            state: stateInput.value,
            mapboxAddress: address,
            // Adicione mais campos conforme necessário
        };

        // Convertendo para JSON
        const jsonData = JSON.stringify(formData);

        // Exibindo os dados em JSON no console (você pode enviar ou processar conforme necessário)
        console.log(jsonData);

        // Restante do seu código...
    });
}
)}
)}           
</script>
</body>

</html>
