<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <title>Resultado Pesquisa tela do Prestador</title>

    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@200;400;600&family=Roboto:ital,wght@0,400;1,500&display=swap"
        rel="stylesheet">

    <link href="https://api.mapbox.com/mapbox-gl-js/v2.10.0/mapbox-gl.css" rel="stylesheet" />
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.10.0/mapbox-gl.js"></script>

    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
</head>

<body style="max-height: 100vh; overflow-y: auto; margin: 0;">



    <header class="navbar navbar-expand-lg navbar-light bg-light fixed-header"
        style="background-color: #e9e4ff !important;">
        <a class="navbar-brand" href="index.html"><img src="img/Logo.png" alt="" style="width: 100px;">FromHome</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
            aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <i class="fa fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse justify-content-center" style="margin-right: 100px" id="navbarNav"
            id="navbarNav">
            <ul class="navbar-nav text-center">
                <li class="nav-item">
                    <a class="nav-link" href="index.html">Sobre</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="listademandascandidato.html">Suas Demandas</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="registroservicos.html">Criar Demanda</a>
                </li>
            </ul>
        </div>
        <div class="nav-item dropdown ml-2">
            <a class="nav-link dropdown-toggle" href="#" id="profileDropdown" data-toggle="dropdown"
                aria-haspopup="true" aria-expanded="false">
                <img src="img/foto_perfil.jpg" alt="Sua Foto de Perfil" class="rounded-circle" width="40" height="40">
            </a>
            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="profileDropdown"
                style="background-color: rgb(229, 216, 255); color: rgb(0, 0, 0); border: 3px;">
                <a class="dropdown-item" href="perfilindividual.html">Perfil</a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="index.html">Sair</a>
            </div>
        </div>

    </header>

    <style>
        .card {
            width: 100%;
            text-align: justify;
            border: none;

        }



        .btn {
            background-color: blueviolet;

        }

        .btn:hover,
        #a:hover {
            background-color: rgb(226, 43, 144);

        }

        .container {
            height: 90%;
            /* Ajuste conforme necessário */
        }

        .card img {
            max-width: 20%;
            max-height: 20%;
        }


        .card h5 {
            margin-top: 0;
        }




        .map-container {
            /* Outras regras existentes */
            display: flex;
            flex-direction: column;
        }
        h6 {
        font-weight: bold; 
        color: #801CEB;
        }
    </style>

    <main>
        <div class="container-fluid" style="overflow-y: auto; padding-bottom: 10%;">
            <div class="row mt-5 pt-3 justify-content-center">
                <div class="col-12 col-md-11 pt-2 rounded" style="background-color: rgb(128, 28, 235);">
                    <div class="row">
                        <div class="col-9 col-md-11" style="overflow-y: auto; ">
                            <input list="sugestoes" class="form-control" placeholder="Pesquisar" style="text-align: left;" id="Pesquisar">
                            <datalist id="sugestoes">
                                <option value="Babá Cuidados com Crianças">
                                <option value="Cozinha e Culinária">
                                <option value="Cuidados com Animais de Estimação">
                                <option value="Jardinagem">
                                <option value="Limpeza">
                                <option value="Manutenção Residencial">
                                <option value="Motorista Particular">
                                <option value="Organização de Espaços">
                                <option value="Serviços de Lavanderia">
                                <option value="Tutoria Acadêmica">
                                <option value="Outro">
                            </datalist>
                        </div>




                        <div class="col-3 col-md-1 text-center "><!-- tela de busca -->
                            <a id="spaghetti" class="btn mb-3"
                                style="background-color: rgb(196, 148, 247); color: rgb(255, 255, 255); text-align: center;">
                                Buscar
                            </a>
                        </div>


                    </div>




                    <div class="row justify-content-center"><!-- cards coluna 1 -->
                        <div class="col-md-6" id="texto" style="background-color: rgb(196, 148, 247);">


                            <section>
                                <div class="container">
                                    <div id="cardhost" style="max-height: 400px; overflow: auto;"> <!-- cards 1 mapa inicial -->
                                        <div class="card mb-3 mt-2 " style="max-width: 555px;">
                                            <div class="card">
                                                <div class="row g-0" id="jogos-container">



                                                    <div class="col-md-12" id="card1">
                                                        <div class="card-body">
                                                            <p class="card-text text-center" id="cidadeEstado"></p>
                                                        </div>
                                                    </div>
                                                </div>


                                            </div>

                                        </div>
                                        <div class="card mb-3 mt-2" style="max-width: 555px;">
                                            <div class="card">
                                                <div class="row g-0" id="jogos-container">
                                                    <div class="col-md-12" id="card2">
                                                        <div class="card-body">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="card mb-3 mt-2" style="max-width: 555px;">
                                            <div class="card">
                                                <div class="row g-0" id="jogos-container">
                                                    <div class="col-md-12" id="card3">
                                                        <div class="card-body">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="card mb-3 mt-2" style="max-width: 555px;">
                                            <div class="card">
                                                <div class="row g-0" id="jogos-container">
                                                    <div class="col-md-12" id="card4">
                                                        <div class="card-body">

                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>

                                        <div class="card mb-3 mt-2" style="max-width: 555px;">
                                            <div class="card">
                                                <div class="row g-0" id="jogos-container">
                                                    <div class="col-md-12" id="card5">
                                                        <div class="card-body">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="card mb-3 mt-2" style="max-width: 555px;">
                                            <div class="card">
                                                <div class="row g-0" id="jogos-container">
                                                    <div class="col-md-12" id="card6">
                                                        <div class="card-body"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>


                                        <div class="card mb-3 mt-2" style="max-width: 555px;">
                                            <div class="card">
                                                <div class="row g-0" id="jogos-container">
                                                    <div class="col-md-12" id="card7">
                                                        <div class="card-body">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>


                                        <div class="card mb-3 mt-2" style="max-width: 555px;">
                                            <div class="card">
                                                <div class="row g-0" id="jogos-container">
                                                    <div class="col-md-12" id="card8">
                                                        <div class="card-body">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </div>





                        <div class="col-md-6 justify-content-center" style="background-color: rgb(196, 148, 247);">
                            <h4 class="text-center pt-3 mb-2" id="titulo" style="font-size: 24px;"><b></b></h4>
                            <h6 class="mb-2" id="status" style="font-size: 18px;"><b></b></h6>
                            <h6 class="mb-2 text-center" id="descricao" style="font-size: 18px;"><b></b></h6>
                            <h6 class="mb-2" id="paragrafo" style="font-size: 13px;"><b> </b></h6>
                            <h6 class="mb-1" id="localizacao" style="font-size: 18px;"><b></b></h6>

                            <!-- Container for map and additional information -->
                            <div class="map-container" id="map-container1"
                                style="height: 300px; display: flex; flex-direction: column; align-items: center;">
                                <!-- Map container -->
                                <div id="map1" style="flex: 1; width: 100%;"></div>

                                <!-- Additional information container -->
                                <div class="col-auto mt-3">
                                    <a id="spaghetti1" class="btn btn-custom"
                                        style="background-color: rgb(128, 28, 235); color: rgb(255, 255, 255); width: 150px;">
                                        Candidatar-se
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
    </main>


    <footer class="text-light mt-auto rodape"
        style="background-color: rgb(58, 50, 77); width: 100%; bottom: 0; position: fixed; padding-bottom: 0px;">
        <div class="navbar navbar-expand-lg navbar-light bg-light" style="background-color: #e9e4ff !important;">
            <a class="navbar-brand" href="index.html"><img src="img/Logo.png" alt="" style="width: 100px;"></a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-center" style="margin-right: 100px" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="ajuda.html">Ajuda</a>
                    </li>
                        <li class="nav-item">
                            <a class="nav-link"id="termosDeUso">Termos de Uso</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="politicasPrivacidade">Políticas de Privacidade</a>
                        </li>
                      </ul>
            </div>
        </div>
        <div class="container text-center mt-1">
            <p>Contato: contato@fromhome.com<br>Telefone: (11) 1234-5678</p>
        </div>
        <p class="text-center small">&copy; 2023 FromHome. Todos os direitos reservados.</p>
    </footer>
    <div style="height: 100px;"></div>


    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="../js/modais.js"></script>
    <script>

        $("#loginForm").submit(function (event) {
            event.preventDefault();
            let Funcao = localStorage.getItem("varFuncao");
            `alert = "Funcao"`;
            if (Funcao == "prestador") {
                window.location.href = "buscarVagas.html";
            }
            else {
                window.location.href = "tamplate.html";
            }
        });


    </script>
    <div style="height: 100px;"></div>


    <script>
        function exibirMapa(rua, cidade, estado, titulo, descricao, containerId) {
            const mapboxAccessToken = 'pk.eyJ1Ijoid2FuZXNzYWNyaXN0aW5hIiwiYSI6ImNscHBmeDN3bDBwNXoyanBwNDd1NHdjbWoifQ.mn9RiaWKROJGkiLQynhltg';

            fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${rua},${cidade},${estado}.json?access_token=${mapboxAccessToken}`)
                .then(response => response.json())
                .then(data => {
                    const [longitude, latitude] = data.features[0].center;

                    mapboxgl.accessToken = mapboxAccessToken;

                    // Create map without affecting the layout
                    const map = new mapboxgl.Map({
                        container: 'map1',
                        style: 'mapbox://styles/mapbox/streets-v11',
                        center: [longitude, latitude],
                        zoom: 13,
                    });

                    new mapboxgl.Marker().setLngLat([longitude, latitude]).addTo(map);

                    // Set the title and description in the respective HTML elements
                    document.getElementById('titulo').textContent = titulo;
                    document.getElementById('descricao').textContent = descricao;


                    const localizacaoDiv = document.getElementById('localizacao');
                    localizacaoDiv.textContent = `Endereço: ${rua}, ${cidade}, ${estado}`;
                });

        }


        let selected_album = null
        function buildCard(album) {
            const card = document.createElement("div");
                        card.classList.add("card");

                        const img = document.createElement("img");
                        img.src = album.photo;
                        img.alt = album.name;
                        img.classList.add("card-img-top", "img-fluid");

                        const titulo = document.createElement("h5");
                        titulo.textContent = album.name;
                        titulo.classList.add("text-center");

                        const categoria = document.createElement("p");
                        categoria.classList.add("card-text", "text-center", "mb-0");
                        categoria.textContent = album.category;

                        const preco = document.createElement("p");
                        preco.classList.add("card-text", "text-center", "mb-1");
                        preco.textContent = `Valor: ${album.price} R$`;

                        const cidadeEstado = document.createElement("p");
                        cidadeEstado.id = 'cidadeEstado';
                        cidadeEstado.classList.add("card-text", "text-center", "mb-2");
                        cidadeEstado.textContent = `${album.city}, ${album.region}`;

                        const cardBody = document.createElement("div");
                        cardBody.classList.add("card-body");
                        cardBody.appendChild(img);
                        cardBody.appendChild(titulo);
                        cardBody.appendChild(categoria);
                        cardBody.appendChild(preco);
                        cardBody.appendChild(cidadeEstado);

                        const linkMaisInformacoes = document.createElement("button");
                        linkMaisInformacoes.classList.add("btn", "me-2");
                        linkMaisInformacoes.textContent = "Mais informações";
                        linkMaisInformacoes.onclick = function () {
                            selected_album = album
                            exibirMapa(album.location, album.city, album.region, album.name, album.description);
                        };

                        const divCentralizada = document.createElement("div");
                        divCentralizada.classList.add("d-flex", "flex-column", "align-items-center");
                        divCentralizada.appendChild(linkMaisInformacoes);

                        cardBody.appendChild(divCentralizada);
                        card.appendChild(cardBody);
                        return card
        }
        let cuzcuz = []
        function carregar(query="") {
            cuzcuz.forEach(child => child.remove());
            fetch(`/api/list_services?query=${query}`)
                .then(response => response.json())
                .then(servicos => {
                    console.log("Dados do db.json:", servicos);

                    const albuns = servicos.slice(0, 250);

                    albuns.forEach((album, index) => {
                        let card = buildCard(album);
                        cuzcuz.push(card)
                        document.querySelector(`#card${index + 1}`).appendChild(card);
                    });
                });
        }

        document.getElementById("Pesquisar").addEventListener("keydown", (e) => { carregar(e.target.value) })
        carregar();
        let felicidade = null
        document.getElementById("spaghetti").addEventListener("click",felicidade = (e) => {
            e.preventDefault()
            
            $.ajax({
                type: "POST",
                url: "/api/submit",
                data: JSON.stringify({service_id: selected_album.service_id}),
                contentType: 'application/json', 
                success: function(response) {
                //$('#cadastroConcluidoMessage').text('Login realizado com sucesso!');
                //$('#confirmacaoModal').modal('show');
                console.log(response);
                },
                error: function(error) {
                console.error(error);
                }
            });
        })
        document.getElementById("spaghetti1").addEventListener("click", felicidade)
    </script>




</body>
<script src="barradepesquisademanda.js"></script>
</html>