<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
    <title>Registro de Serviços</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <script id="search-js" defer="" src="https://api.mapbox.com/search-js/v1.0.0-beta.18/web.js"></script>

    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@200;400;600&family=Roboto:ital,wght@0,400;1,500&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>



    <link rel="stylesheet"
        href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.0/mapbox-gl-geocoder.css"
        type="text/css" />

    <style>
        b {
            color: #3a2866;
        }


        .content {
            padding: 2rem;
            display: flex;
            flex-direction: column;
            ;

        }

        .span-required {
            display: none;
            font-size: 12px;
            color: rgb(255, 0, 0)
        }

        select {
            border-color: #8878ce;
        }

        select:focus {
            outline: none;
            /* Remove a borda padrão do foco */
            border: 3px solid #8878ce;
        }

        select option {
            color: rgb(89, 52, 114);
            background-color: #e6d1ff;
        }


        .form-label {
            font-weight: bold;
            font-size: 18px;
        }

        h1 {
            color: rgb(89, 52, 114);
        }

        .form-control {
            outline: none;
            /* Remove a borda padrão do foco */
            border-color: rgb(89, 52, 114);

            box-sizing: border-box;
        }

        .form-control:focus {
            outline: none;
            /* Remove a borda padrão do foco */
            border: 3px solid rgb(89, 52, 114);
        }


        .form-label {
            color: rgb(89, 52, 114);
        }

        #postarBtn {
            background-color: #801CEB;
            color: white;
            font-size: 18px;
            border-radius: 20%;
        }

        #postarBtn:hover {
            background-color: #be51be;

        }

        #postarBtn {
            text-align: center;

            margin-left: 1rem;
        }



        .inputOpcoes {
            width: 100%;
            /* Define a largura do select */
            padding: 8px;
            /* Adiciona preenchimento interno */
            border: 1px solid rgb(89, 52, 114);
            /* Adiciona uma borda ao redor do select */
            border-radius: 5px;
            /* Borda arredondada */
        }

        /* Estilo quando o select está focado */
        .inputOpcoes:focus {
            outline: none;
            /* Remove a borda de foco padrão */
            border-color: rgb(89, 52, 114);
            /* Muda a cor da borda quando o select está focado */
            box-shadow: 0 0 5px rgb(89, 52, 114);
            /* Adiciona uma sombra quando o select está focado */
        }

        /* Estilo da seta (triângulo) do select */
        .inputOpcoes::-ms-expand {
            display: none;
            /* Remove a seta no Internet Explorer */
        }

        .inputOpcoes:after {
            content: '\25BC';
            /* Adiciona uma seta usando o código Unicode */
            position: absolute;
            /* Posiciona a seta */
            top: 50%;
            /* Alinha a seta verticalmente */
            right: 10px;
            /* Define a distância da borda direita */
            transform: translateY(-50%);
            /* Ajusta verticalmente a seta */
        }

        /* Altera a cor do texto dentro do select */
        .inputOpcoes option {
            color: rgb(89, 52, 114);
        }
    </style>



</head>

<body>
<header class="navbar navbar-expand-lg navbar-light bg-light fixed-header"
    style="background-color: #e9e4ff !important;">
    <a class="navbar-brand" href="index.html">
        <img src="../img/Logo.png" alt="" style="width: 100px;">FromHome
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
        aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <i class="fa fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse justify-content-center" style="margin-right: 100px" id="navbarNav"
        id="navbarNav">
        <ul class="navbar-nav text-center">
            <li class="nav-item">
                <a class="nav-link" href="index.html">Sobre</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="listademandacliente.html">Suas Demandas</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="registroservicos.html">Criar Demanda</a>
            </li>
        </ul>
    </div>
    <div class="nav-item dropdown ml-2">
        <a class="nav-link dropdown-toggle" href="#" id="profileDropdown" data-toggle="dropdown" aria-haspopup="true"
            aria-expanded="false">
            <img src="../img/foto_perfil.jpg" alt="Sua Foto de Perfil" class="rounded-circle" width="40" height="40">
        </a>
        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="profileDropdown"
            style="background-color: rgb(229, 216, 255); color: rgb(0, 0, 0); border: 3px;">
            <a class="dropdown-item" href="perfilindividual.html">Perfil</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="index.html">Sair</a>
        </div>
    </div>

</header>

    <!-- Conteúdo principal da página -->
    <div class="content" style="margin-bottom: 200px;  font-family: 'Poppins';">
        <!-- conteúdo principal -->
        <div class="row mt-5 justify-content-center">
            <div class="col-lg-7 mx-auto">
                <div class="card mt-5 mx-auto p-4" >
                    <div class="card-body">
                        <h1 class="text-center"><b>Registro de Serviço</b></h1>
                    </div>
                    <div class="container mt-5">
                        <form class="row g-3" method="POST" name="checkoutForm">

                            <div class="col-md-6">
                                <label for="inputNameS" class="form-label">Nome do serviço</label>
                                <input name="nome" class="form-control required" id="inputNomeServico"
                                    oninput="nameValidate()" onblur="nameValidate()" />
                                <span class="span-required" id="mensagemErroNome">
                                    <p>O nome deve ter no mínimo 4 caracteres</p>
                                </span>
                            </div>

                            <div class="col-md-6 col-sm-6">
                                <label name="categoria" for="inputOpcoes" class="form-label ">Categoria</label>
                                <select id="inputOpcoes" class="form-select inputOpcoes required" required
                                    onchange="categoriaValidate()" onblur="categoriaValidate()">
                                    <option value="" selected></option>
                                    <option>Babá Cuidados com Crianças</option>
                                    <option>Cozinha e Culinária</option>
                                    <option>Cuidados com Animais de Estimação</option>
                                    <option>Jardinagem</option>
                                    <option>Limpeza</option>
                                    <option>Manutenção Residencial</option>
                                    <option>Motorista Particular</option>
                                    <option>Organização de Espaços</option>
                                    <option>Serviços de Lavanderia</option>
                                    <option>Tutoria Acadêmica</option>
                                    <option>Outro</option>

                                </select>
                                <span class="span-required" id="mensagemErroOpcoes">
                                    <p>É necessário escolher uma opção</p>
                                </span>
                            </div>


                            <div class="col-md-12 mt-2 col-sm-4 "> <!-- descricao -->

                                <label for="inputDescricaoServico" class="form-label ">Descrição do serviço</label>
                                <textarea name="descricao" class="form-control required" id="inputDescricaoServico"
                                    cols="25" rows="4" required oninput="descricaoValidate()"
                                    onblur="descricaoValidate()"></textarea>
                                <span class="span-required" id="mensagemErroDescricao">
                                    <p>A descrição deve ter no mínimo 20 caracteres</p>
                                </span>
                            </div>

                            <div class="col-md-6 mt-3 ">
                                <label for="inputFotos" class="form-label">Fotos(opcional)</label>
                                <input name="foto" type="file" class="form-control" id="inputFotos" accept="image/*"
                                    style="resize: vertical;" rows="4"  />
                            </div>

                            <div class="col-md-6 mt-3">
                                <label for="inputDisponibilidade" class="form-label">Horário estimado</label>
                                <input name="disponibilidade" type="time" class="form-control required"
                                    id="inputDisponibilidade" required style="width: 100%;"
                                    onchange="disponibilidadeValidate()" onblur="disponibilidadeValidate()" />
                                <span class="span-required" id="mensagemErroDisponinbilidade">
                                    <p>Horário minímo 30min</p>
                                </span>
                            </div>


                            <div class="col-md-6 mt-1">
                                <label for="inputData" class="form-label">Data de previsão</label>
                                <input name="data" type="date" class="form-control required" id="inputData"
                                    pattern="[0-9]{4}-[0-9]{2}-[0-9]{2}" max="9999-12-31" required
                                    onchange="dataValidate()" onblur="dataValidate()" />
                                <span class="span-required" id="mensagemErroData">
                                    <p></p>
                                </span>
                            </div>



                            <div class="col-md-6 mt-1">
                                <label for="inputPreco" class="form-label">Valor</label>
                                <input name="preco" type="text" class="form-control required" id="inputPreco"
                                    step="000.01" placeholder="R$:" style="width: 100%" required
                                    onblur="precoValidate()" oninput="precoValidate()" />
                                <span class="span-required" id="mensagemErroPreco">
                                    <p>Mensagem de validação para valor</p>
                                </span>
                            </div>



                            <div class="col-md-6 col-sm-6">
                                <div class="form-group">

                                    <label for=" " class="form-label">Endereço</label>
                                    <label for="inputLocal" class="txt-s txt-bold color-gray mb-0 mt-0">(Rua)</label>
                                    <input class="input mb-3 form-control required" required placeholder="Escreva seu endereco"
                                        autocomplete="address-line1" id="inputLocal" style="resize: vertical;" rows="2"
                                        oninput="enderecoValidate()" onblur="enderecoValidate()">
                                    <span class="span-required" id="mensagemErroEndereco">
                                        <p>O endereço deve ter no mínimo 3 caracteres</p>
                                    </span>

                                    <div id="manual-entry"
                                        class="w180 mt6 link txt-ms border-b color-gray color-black-on-hover"></div>
                                    <div class="secondary-inputs hide" style="resize: vertical;" rows="2">

                                        <label class="txt-s txt-bold color-gray mb3 md-1">Cidade</label>
                                        <input class="input mt-0 mb-3 form-control" placeholder="Cidade"
                                            autocomplete="address-level2" id="cityInput" readonly>

                                        <label class="txt-s txt-bold color-gray mb3 md-1">Estado / Região</label>
                                        <input class="input mb12 form-control" placeholder="Estado / Região"
                                            autocomplete="address-level1" id="stateInput" readonly>


                                        <div class="col-md-1">
                                            <!-- Visual confirmation map -->
                                            <div id="minimap-container" class="none h240 w360 relative mt18"></div>
                                        </div>

                                        <div id="validation-msg" class="mt24 txt-m txt-bold none"></div>
                                    </div>
                                </div>
                            </div>



                            <div class="col-md-6 mt-5">
                                <div class="form-check">
                                    <input name="contato" class="form-check-input" type="checkbox" id="gridCheck" />
                                    <label class="form-check-label" for="gridCheck">
                                        Mostrar meu número de contato
                                    </label>



                                    <div class="col-md-12 mt-5 pt-4">
                                        <button id="postarBtn" type="submit" class="btn btn-primary" href="listademandascandidato.html">
                                            Postar
                                        </button>
                                    </div>
                                </div>
                            </div>

                        </form>
                    </div>
                </div>

            </div>
        </div>
    </div>


    <footer class="text-light mt-1" style="background-color: rgb(58, 50, 77); position: fixed; bottom: 0; width: 100%;">
        <div class="navbar navbar-expand-lg navbar-light bg-light" style="background-color: #e9e4ff !important;">
            <a class="navbar-brand" href="index.html"><img src="../img/Logo.png" alt="" style="width: 100px;"></a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-center" style="margin-right: 100px" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                    <li class="nav-item">
                        <a class="nav-link" href="ajuda.html">Ajuda</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="termosDeUso">Termos de Uso</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="politicasPrivacidade">Políticas de Privacidade</a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="container text-center mt-1">
            <p>Contato: contato@fromhome.com<br />Telefone: (11) 1234-5678</p>
        </div>
        <p class="text-center small">
            &copy; 2023 FromHome. Todos os direitos reservados.
        </p>
    </footer>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="../js/login.js"></script>
    <script src="../js/modais.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://api.mapbox.com/search-js/v1.0.0-beta.18/web.js" defer></script>
    <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.0/mapbox-gl-geocoder.js"></script>
    <script src="server.js"></script>
    
  

    

    <script>
        const ACCESS_TOKEN = 'pk.eyJ1Ijoid2FuZXNzYWNyaXN0aW5hIiwiYSI6ImNscHBmeDN3bDBwNXoyanBwNDd1NHdjbWoifQ.mn9RiaWKROJGkiLQynhltg';

        let autofillCollection;
        let minimap;


        // Form operation functions
        function showMap() {
            const el = document.getElementById("minimap-container");
            el.classList.remove("none");
        }

        function hideMap() {
            const el = document.getElementById("minimap-container");
            el.classList.add("none");
        }

        const manualEntryButton = document.getElementById("manual-entry");
        if (manualEntryButton) {
            manualEntryButton.addEventListener("click", expandForm);
        }

        function expandForm() {
            document.getElementById("manual-entry").classList.add("hide");
            document.querySelector(".secondary-inputs").classList.remove("hide");
        }

        function collapseForm() {
            document.getElementById("manual-entry").classList.remove("hide");
            document.querySelector(".secondary-inputs").classList.add("hide");
        }

        function setValidationText(color, msg, clear = false) {
            const validationTextElement = document.getElementById("validation-msg");
            if (clear) validationTextElement.classList.add("none");
            validationTextElement.classList.remove("color-green", "color-red");
            validationTextElement.classList.add(`color-${color}`);
            validationTextElement.innerText = msg;
            validationTextElement.classList.remove("none");
        }

        function submitForm() {
            setValidationText("green", "Order successfully submitted.");
            setTimeout(() => {
                resetForm();
            }, 2500);
        }

        function resetForm() {
            const inputs = document.querySelectorAll("input");
            inputs.forEach(input => input.value = "");
            collapseForm();
            setValidationText("green", "", true)
            autofillCollection.update();
            minimap.feature = null;
        }

        // Bind functions to HTML buttons
        document.getElementById("manual-entry").addEventListener("click", expandForm);

        // Autofill initialization
        document.getElementById("search-js").onload = () => {
            mapboxsearch.config.accessToken = ACCESS_TOKEN;

            autofillCollection = mapboxsearch.autofill({});

            minimap = new MapboxAddressMinimap();
            minimap.canAdjustMarker = true;
            minimap.satelliteToggle = true;
            minimap.onSaveMarkerLocation = (lnglat) => {
                console.log(`Marker moved to ${lnglat}`);
            };
            const minimapContainer = document.getElementById("minimap-container");
            minimapContainer.appendChild(minimap);

            autofillCollection.addEventListener(
                "retrieve",
                async (e) => {
                    expandForm();
                    if (minimap) {
                        minimap.feature = e.detail.features[0];
                        showMap();
                    }
                }
            );

            document.addEventListener("DOMContentLoaded", () => {
                const form = document.forms.checkoutForm;

                form.addEventListener("submit", async (e) => {
                    e.preventDefault();


                    // Obtendo dados do formulário
                    const addressInput = document.getElementById("inputLocal");
                    const cityInput = document.getElementById("cityInput");
                    const stateInput = document.getElementById("stateInput");

                    // Obtendo dados da biblioteca Mapbox Search
                    const address = autofillCollection.get("address-line1");

                    // Criando um objeto com os dados do formulário
                    const formData = {
                        address: addressInput.value,
                        city: cityInput.value,
                        state: stateInput.value,
                        mapboxAddress: address,
                        // Adicione mais campos conforme necessário
                    };

                    // Convertendo para JSON
                    const jsonData = JSON.stringify(formData);

                    // Exibindo os dados em JSON no console (você pode enviar ou processar conforme necessário)
                    console.log(jsonData);

                    // Restante do seu código...
                });
            }
            )
        }




    </script>

    <script> //para validar o formulario
        const form = document.querySelector('.row.g-3');
        const campos = document.querySelectorAll('.required');
        const span = document.querySelectorAll('.span-required');



        function setError(index) {
            campos[index].style.border = '2px solid #ff0000';
            span[index].style.display = 'block';
        }

        function removeError(index) {
            campos[index].style.border = '2px solid #652b77 ';
            span[index].style.display = 'none';
        }





        //validar os campos

        function nameValidate() {
            const usernameInput = document.getElementById("inputNomeServico");
            const mensagemErroUsername = document.getElementById("mensagemErroNome");

            const setError = (errorMessage) => {
                usernameInput.style.border = '2px solid #ff0000';
                mensagemErroUsername.style.display = 'block';
                mensagemErroUsername.textContent = errorMessage;
            };

            const removeError = () => {
                usernameInput.style.border = '2px solid #652b77';
                mensagemErroUsername.style.display = 'none';
            };

            if (usernameInput.value.trim().length === 0) {
                setError("Este campo é obrigatório.");
                return false;
            } else if (usernameInput.value.length < 4) {
                setError("O nome deve ter pelo menos 4 caracteres.");
                return false;
            } else {
                removeError();
                return true;
            }
        }


        //categoria
        function categoriaValidate() {
            const selectElement = document.getElementById('inputOpcoes');
            const selectedOption = selectElement.options[selectElement.selectedIndex].value;

            if (selectedOption === '') {
                console.log('Você não selecionou nada');
                setError(inputOpcoes, mensagemErroOpcoes, 'Campo obrigatório');
                return false;
            } else {
                console.log('Você selecionou: ' + selectedOption);
                removeError(inputOpcoes, mensagemErroOpcoes,);
                return true;
            }
        }


        function setError(element, errorMessageElement, errorMessage) {
            element.classList.add('error');
            errorMessageElement.style.display = 'block';
            element.style.border = '2px solid #ff0000';
            errorMessageElement.textContent = errorMessage;
            console.log('Erro: Implemente a lógica para exibir um erro aqui.');
        }

        function removeError(element, errorMessageElement) {
            element.classList.remove('error');  // Remova a classe de erro
            errorMessageElement.style.display = 'none';
            console.log('Removendo erro: Implemente a lógica para remover o erro aqui.');
        }


        // Adicionando um ouvinte de evento para reverter a borda quando o usuário interagir novamente com o select

        function descricaoValidate() {
            const usernameInput = document.getElementById("inputDescricaoServico");
            const mensagemErroUsername = document.getElementById("mensagemErroDescricao");

            const setError = (errorMessage) => {
                usernameInput.style.border = '2px solid #ff0000';
                mensagemErroUsername.style.display = 'block';
                mensagemErroUsername.textContent = errorMessage;
            };

            const removeError = () => {
                usernameInput.style.border = '2px solid #652b77';
                mensagemErroUsername.style.display = 'none';
            };

            if (usernameInput.value.trim().length === 0) {
                setError("Este campo é obrigatório.");
                return false;
            } else if (usernameInput.value.length < 20) {
                setError("A descrição deve ter no mínimo 20 caracteres");
                return false;
            } else {
                removeError();
                return true;
            }
        }



        function enderecoValidate() {
            const usernameInput = document.getElementById("inputLocal");
            const mensagemErroUsername = document.getElementById("mensagemErroEndereco");

            const setError = (errorMessage) => {
                usernameInput.style.border = '2px solid #ff0000';
                mensagemErroUsername.style.display = 'block';
                mensagemErroUsername.textContent = errorMessage;
            };

            const removeError = () => {
                usernameInput.style.border = '2px solid #652b77';
                mensagemErroUsername.style.display = 'none';
            };

            if (usernameInput.value.trim().length === 0) {
                setError("Este campo é obrigatório.");
                return false;
            } else if (usernameInput.value.length < 4) {
                setError("o endereço deve ter no mínimo 4 caracteres");
                return false;
            } else {
                removeError();
                return true;
            }
        }




        document.getElementById('inputDisponibilidade').addEventListener('focusout', disponibilidadeValidate);

        function disponibilidadeValidate() {
            const inputDisponibilidade = document.getElementById('inputDisponibilidade');
            const mensagemErroDisponibilidade = document.getElementById('mensagemErroDisponinbilidade');
            const valor = inputDisponibilidade.value;

            // Verificar se o valor é vazio
            if (valor.trim() === '') {
                console.log('Campo obrigatório');
                setError(inputDisponibilidade, mensagemErroDisponibilidade, 'Campo obrigatório');
                return false;
            } else {
                removeError(inputDisponibilidade, mensagemErroDisponibilidade);
                return true;
            }
        }

        function setError(element, errorMessageElement, errorMessage) {
            element.classList.add('error');
            errorMessageElement.style.display = 'block';
            element.style.border = '2px solid #ff0000';
            errorMessageElement.textContent = errorMessage;
            console.log('Erro: Implemente a lógica para exibir um erro aqui.');
        }

        function removeError(element, errorMessageElement) {
            element.classList.remove('error');  // Remova a classe de erro
            errorMessageElement.style.display = 'none';
            console.log('Removendo erro: Implemente a lógica para remover o erro aqui.');
        }


        
            function dataValidate() {
                console.log('Função dataValidate chamada.');
                const inputData = document.getElementById('inputData');
                const mensagemErroData = document.getElementById('mensagemErroData');
                const valor = inputData.value;

                // Verifica se a data selecionada foi preenchida
                if (valor === '') {
                    console.log('Campo de data selecionada não preenchido');
                    setError(inputData, mensagemErroData, 'Campo obrigatório');
                    return false;
                }

                // Obtendo a data e hora atual
                const dataAtual = new Date();

                // Convertendo o valor para um objeto Date
                const dataSelecionada = new Date(valor);

                console.log('Data atual:', dataAtual);
                console.log('Data selecionada:', dataSelecionada);

                // Verificando se a data selecionada é posterior à data atual
                if (dataSelecionada <= dataAtual) {
                    console.log('A data selecionada deve ser posterior à data atual');
                    setError(inputData, mensagemErroData, 'A data deve ser posterior à data atual');
                    return false;
                }

                // Verificando se a diferença em anos é menor ou igual a 3
                const diffAnos = Math.floor((dataSelecionada - dataAtual) / (365.25 * 24 * 60 * 60 * 1000));
                if (diffAnos > 3) {
                    console.log('A diferença em anos deve ser no máximo 3');
                    setError(inputData, mensagemErroData, 'A diferença em anos deve ser no máximo 3');
                    return false;
                }

                removeError(inputData, mensagemErroData);

                console.log('A data selecionada é válida.');
                // Se chegou até aqui, a data selecionada é válida.
                return true;
            }

        function precoValidate() {

            const inputPreco = document.getElementById('inputPreco');
            const mensagemErroPreco = document.getElementById('mensagemErroPreco');
            const valor = inputPreco.value;

            // Obter o valor atual do campo sem remover formatação
            const valorAtual = inputPreco.value;


            if (valorAtual.trim() === '') {
                console.log('Campo obrigatório');
                setError(inputPreco, mensagemErroPreco, 'Campo obrigatório');
                return false;
            }
            // Verificar se o valor atual já contém uma vírgula
            const contemVirgula = valorAtual.includes(',');

            // Remover qualquer formatação de moeda antes de converter para número
            const valorStr = valorAtual.replace(/[^\d,]/g, '');

            // Verificar se a string contém notação científica
            const isScientificNotation = valorStr.toLowerCase().includes('e');

            // Se não for notação científica, converter para número
            const valorNumerico = isScientificNotation ? 0 : parseFloat(valorStr.replace(',', '.'));

            if (isNaN(valorNumerico) || valorNumerico <= 0) {
                console.log('O valor deve ser maior que zero');
                setError(inputPreco, mensagemErroPreco, 'O valor deve ser maior que zero');
                return false;
            } else {
                removeError(inputPreco, mensagemErroPreco);

                // Atualizar o valor do campo sem formatação durante a entrada
                inputPreco.value = valorNumerico.toFixed(2);

                // Adicionar ",00" ao valor para garantir duas casas decimais com vírgula
                const valorFormatado = contemVirgula
                    ? valorNumerico.toLocaleString('pt-BR', {
                        minimumFractionDigits: 2,
                        maximumFractionDigits: 2,
                    })
                    : valorNumerico.toFixed(2).replace('.', ',');

                // Atualizar o valor do campo com a versão formatada
                inputPreco.value = valorFormatado;
                return true;
            }
        }
        function removeError(element, errorMessageElement) {
            element.classList.remove('error');  // Remova a classe de erro
            errorMessageElement.style.display = 'none';
            element.style.border = '1px solid #652b77'; // Oculte a mensagem de erro
            console.log('Erro removido.');
        }

        function setError(element, errorMessageElement, errorMessage) {
            element.classList.add('error');
            errorMessageElement.style.display = 'block';
            element.style.border = '2px solid #ff0000';
            errorMessageElement.textContent = errorMessage;
            console.log('Erro: Implemente a lógica para exibir um erro aqui.');
        }
        // Adicionar um ouvinte de evento 'blur' para chamar precoValidate quando o foco é retirado do campo
        document.getElementById('inputPreco').addEventListener('blur', precoValidate);

    </script>






</body>

</html>